---
title: "SOC-5811 Week 5: Sampling distributions and inference I"
author: "Nick Graetz"
date: "9/29/2025"
output: 
    beamer_presentation:
        incremental: false
        includes: 
            in_header: Minnesota.tex
---

```{r setup, include=FALSE}
## Libraries
library(tidyverse)
library(data.table)
library(ggplot2)
library(haven)
library(formatR)
library(marginaleffects)
library(cowplot)
# knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 20), tidy = TRUE)
knitr::opts_chunk$set(
 fig.width = 6,
 fig.height = 4,
 warning = FALSE, 
 message = FALSE
)
```

---

\frametitle{Statistical inference}

* \textbf{Parameters} = the unknown numbers that determine a statistical model. 

* Parameters can be used to simulate new data from the model.



---

\frametitle{Statistical inference}

* \textbf{Statistical inference} = a set of operations on data that yield estimates and uncertainty statements about \textbf{predictions and parameters} of some underlying process or population.

* More simply, we observe data and we try to learn something about where it came from.

* \textbf{This involves uncertainty.} 

---

\frametitle{Statistical inference}

* Say I have a population of 1000 people and I ask 30 of them their income.

* The parameter I'm interested in inferring something about is the average income in the entire population.

---

\frametitle{Statistical inference}

\tiny
```{r, echo=FALSE}
test <- data.table(income=round(rnorm(30, 65, 20)))
ggplot(data=test,
       aes(x=income)) + 
  geom_histogram(color=NA,fill='grey') + 
  geom_vline(xintercept = test[,mean(income)], color='red', size=2) + 
  labs(x='Income',y='Count') + 
  theme_bw()
```

---

\frametitle{Statistical inference}

\tiny
```{r, echo=FALSE}
get_sample <- function(i) {
  test <- data.table(income=round(rnorm(30, 65, 20)))
  gg <- ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    labs(x='Income',y='Count') + 
    theme_bw()
  return(gg)
}
test <- lapply(1:6, get_sample)
plot_grid(plotlist = test, nrow=2)
```

---

\frametitle{Sampling distribution}

* \textbf{Sampling distribution} = the set of possible datasets that could have been observed if the data collection process had been re-done, along with the probabilities of these values.

* In practice, we will not know the sampling distribution; we can only estimate it. 

---

\frametitle{Standard errors}

* \textbf{Standard error} = the estimated standard deviation of an estimate (e.g., the standard deviation of the sampling distribution). 

---

\frametitle{Sampling distribution}

\tiny
```{r, echo=FALSE}
get_sample <- function(i) {
  test <- data.table(income=round(rnorm(30, 65, 20)))
  gg <- ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    labs(x='Income',y='Count') + 
    theme_bw()
  return(gg)
}
test <- lapply(1:6, get_sample)
plot_grid(plotlist = test, nrow=2)
```

---

\frametitle{Sampling distribution}

Sampling distribution of the mean:

\tiny
```{r, echo=FALSE}
get_sample <- function(i) {
  test <- data.table(income=round(rnorm(30, 65, 20)))
  return(mean(test[,income]))
}
test <- unlist(lapply(1:1000, get_sample))
test <- data.table(income=test)
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Sampling distribution}

What do you notice about the shape of this distribution?

\tiny
```{r, echo=FALSE}
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Sampling distribution}

Central Limit Theorem

\tiny
```{r, echo=FALSE}
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Sampling distribution}

The \textbf{standard error} is the standard deviation of the sampling distribution of our target statistic.

\tiny
```{r, echo=FALSE}
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Sampling distribution}

The confidence interval represents a range of values of a parameter or quantity of interest that are
roughly consistent with the data, given the assumed sampling distribution.

\tiny
```{r, echo=FALSE}
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    geom_vline(xintercept = test[,mean(income)+1.96*sd(income)], color='red', size=1, linetype='dashed') +
    geom_vline(xintercept = test[,mean(income)-1.96*sd(income)], color='red', size=1, linetype='dashed') +
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Sampling distribution}

However defined, the standard error is a measure of the variation in an estimate and gets smaller
as sample size gets larger, converging on zero as the sample increases in size.

\tiny
```{r, echo=FALSE}
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_vline(xintercept = test[,mean(income)], color='red', size=1) + 
    geom_vline(xintercept = test[,mean(income)+1.96*sd(income)], color='red', size=1, linetype='dashed') +
    geom_vline(xintercept = test[,mean(income)-1.96*sd(income)], color='red', size=1, linetype='dashed') +
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Sampling distribution}

\tiny
```{r, echo=FALSE}
get_sample_size <- function(size) {
  get_sample <- function(i,size) {
    test <- data.table(income=round(rnorm(size, 65, 20)))
    return(mean(test[,income]))
  }
  test <- unlist(lapply(1:1000, get_sample, size=size))
  test <- data.table(income=test)
  test[, size := size]
  return(test)
}
test <- rbindlist(lapply(c(30,100,400), get_sample_size))
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    facet_wrap(~size,nrow=1) + 
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Bias}

It is easy to be very confidently wrong!

```{r, echo=FALSE}
test <- data.table(income=round(rnorm(10000, 65, 20)))
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Bias}

Say only people with incomes above 50k complete my survey:

```{r, echo=FALSE}
test <- data.table(income=round(rnorm(10000, 65, 20)))
ggplot(data=test,
         aes(x=income)) + 
    geom_histogram(color=NA,fill='grey') + 
    geom_histogram(data=test[income>50,], color=NA,fill='red') + 
    labs(x='Income',y='Count') + 
    theme_bw()
```

---

\frametitle{Bias}

* Standard errors capture a particular (but very important!) type of uncertainty: sampling error.

* There are lots of other reasons to be uncertain! 

---

\frametitle{Statistical significance}

What can we do with standard errors?

* Hypothesis testing


